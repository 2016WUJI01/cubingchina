import"bootstrap/dist/css/bootstrap.css";import"font-awesome/css/font-awesome.css";import"../less/styles.less";import"jquery-cookie";import"jquery-countdown";import"bootstrap-hover-dropdown";import ProgressBar from"progressbar.js";import utils from"../utils";import"../plugins/back-to-top/back-to-top";import"../plugins/jquery-placeholder/jquery.placeholder";import"../components/person";import"../components/payment";window.jQuery=window.$=jQuery,window.CubingChina={utils:utils},$(function(){var t,e;$("input, textarea").placeholder(),$(".wrapper table:not(.table)").addClass("table table-bordered table-condensed").parent().addClass("table-responsive"),"ontouchstart"in window||(t=$(window),e=t.height(),$(".table-responsive table").each(function(){var o=$(this),n=o.parent(),s=$("<div>"),a=$('<div class="table-responsive">'),i=o.width(),r=o.height(),c=n.width(),l=n.height(),d=n.offset();o.removeAttr("style width height"),s.css({height:1,width:i}),a.append(s).insertAfter(n).css({position:"fixed"}).on("scroll",function(){n[0].scrollLeft=this.scrollLeft}),n.on("scroll",function(){a[0].scrollLeft=this.scrollLeft}),t.on("scroll",function(){i<=c||r<2*e||e+t.scrollTop()>d.top+l?a.hide():a.show().scrollLeft(n.scrollLeft())}).on("resize",function(){a.css({width:c,bottom:-parseInt(n.css("margin-bottom"))}),t.trigger("scroll"),e=t.height(),i=o.width(),r=o.height(),c=n.width(),l=n.height(),d=n.offset()}).trigger("resize")})),function(){function t(t,e){var n="battle_"+t;$.cookie(n,e,{expires:365,path:"/"}),o()}function e(t){var e="battle_"+t;$.removeCookie(e,{path:"/"}),$('input.battle-person[data-id="'+t+'"]').prop("checked",!1),o()}function o(){var t=n(),o=[];t.length>0?(r.empty(),t.forEach(function(t){o.push(t.id),$('<div class="battle-person">').append($("<a>").attr({href:"/results/person/"+t.id,target:"_blank"}).text(t.name),$('<i class="fa fa-close">').on("click",function(){e(t.id)})).appendTo(r)}),a<t.length&&i.stop().css({right:s?$(window).width()-s.clientX:200,bottom:s?$(window).height()-s.clientY:200}).animate({right:5,bottom:50},800,"swing"),i.show()):i.hide(),t.length>0?l.attr("href","/results/battle/"+o.join("-")):l.attr("href","javascript: void(0)"),a=t.length}function n(){var t=[];return $.each($.cookie(),function(e,o){0===e.indexOf("battle_")&&t.push({id:e.substr("7"),name:o})}),t}var s,a=0,i=$('<div id="battle-control">').appendTo(document.body),r=$('<div class="battle-list">').appendTo(i),c=$('<button class="truncate button"><i class="fa fa-close"></i></button>').appendTo(i),l=$('<a target="_blank" class="button go">GO</a>').appendTo(i);c.on("click",function(){$.each($.cookie(),function(t,o){0===t.indexOf("battle_")&&e(t.substr("7"))}),o()}),$('<button class="rocket button"><i class="fa fa-rocket"></i></button').appendTo(i),i.find("button.rocket").on("focus",function(){i.addClass("active")}).on("blur",function(){i.removeClass("active")}),o(),$(document).on("click","input.battle-person",function(o){var a=$(this).data("id"),i=$(this).data("name");if(this.checked){if(n().length>=4)return o.preventDefault(),!1;s=o,t(a,i)}else e(a)})}(),$("#expand-fee").on("click",function(){var t=$(this),e=t.find("i.fa"),o=t.parent().next();e.hasClass("fa-plus")?(e.removeClass("fa-plus").addClass("fa-minus"),o.height("auto")):(e.addClass("fa-plus").removeClass("fa-minus"),o.height(104).css("overflow-y","hidden"))});var o=0,n=Date.now();$(".countdown-timer").each(function(){var t=$(this),e=[{key:"days",total:t.data("totalDays")||30,offsetKey:"totalDays",progressOptions:{color:"#d9534f",trailColor:"rgba(217, 83, 79, 0.5)"}},{key:"hours",total:24,progressOptions:{color:"#f0ad4e",trailColor:"rgba(240, 164, 78, 0.5)"}},{key:"minutes",total:60,progressOptions:{color:"#5cb85c",trailColor:"rgba(92, 184, 92, 0.5)"}},{key:"seconds",total:60,progressOptions:{color:"#5bc0de",trailColor:"rgba(91, 192, 222, 0.5)"}}];e.forEach(e=>{e.dom=t.find("."+e.key),e.offsetKey=e.offsetKey||e.key,e.progress=new ProgressBar.Circle(e.dom.nextAll(".progress-container").get(0),$.extend({strokeWidth:3,trailWidth:1,duration:1e3},e.progressOptions))}),t.countdown(new Date(n+t.data("remaining"))).on("update.countdown",t=>{var o=t.offset;e.forEach(t=>{t.dom.text(o[t.offsetKey]),t.progress.animate(o[t.offsetKey]/t.total)})})}),setInterval(()=>{parseInt((Date.now()-n)/1e3)!=++o&&(o=0,n=Date.now(),$(".countdown-timer").each(function(){var t=$(this);t.countdown(new Date(n+t.data("remaining")))}))},1e3),window.alertMessages&&!jQuery.cookie("alerted")&&utils.confirm(window.alertMessages.content,{title:window.alertMessages.title,type:"type-danger"}).then(function(){jQuery.cookie("alerted",1,{expires:.5})},function(){jQuery.cookie("alerted",1,{expires:.5})}),(location.hostname.indexOf("cubingchina.com")>-1||location.hostname.indexOf("cubing.com")>-1)&&(function(t,e,o,n,s,a,i){t.GoogleAnalyticsObject=s,t[s]=t[s]||function(){(t[s].q=t[s].q||[]).push(arguments)},t[s].l=1*new Date,a=e.createElement(o),i=e.getElementsByTagName(o)[0],a.async=1,a.src=n,i.parentNode.insertBefore(a,i)}(window,document,"script","//www.google-analytics.com/analytics.js","ga"),ga("create","UA-3512083-6","cubing.com"),ga("send","pageview"),function(){var t=document.createElement("script");t.src="//hm.baidu.com/hm.js?c70291163d20439858ae495f82c3c122";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)}())});